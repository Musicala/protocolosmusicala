/* =============================================================================
  styles.css — Protocolos · Musicala (LIGHT) — PRO+++++ (MEJORADO) v3.3
  -----------------------------------------------------------------------------
  ✅ UI 100% light, premium, legible (Musicala rule)
  ✅ Sidebar filtros + cards + estados (empty / inline)
  ✅ Modal/drawer con checklist + a11y + focus-visible
  ✅ Editor (nuevo/editar): grid bonito, inputs pro, footer sticky, estados
  ✅ Motion safe (reduced-motion) + scrollbars sutiles
  ✅ Fix logo/topbar: estilos para .brand__logo y fallback .brand__mark
  ✅ Mejoras mobile: modales full-height, botones tocables, spacing real
============================================================================= */

/* =========================
   TOKENS
========================= */
:root{
  /* Marca */
  --mozart:#0C41C4;
  --bach:#220A63;
  --brahms:#CE0071;
  --beethoven:#680DBF;

  /* Neutrales light */
  --bg:#f7f8fc;
  --panel:#ffffff;
  --panel2:#fbfcff;
  --panel3:#f1f4ff;

  --ink:#101828;
  --muted:#667085;
  --muted2:#475467;
  --line:#e6e8f0;

  /* Accents */
  --mozart-06: rgba(12,65,196,.06);
  --mozart-10: rgba(12,65,196,.10);
  --mozart-14: rgba(12,65,196,.14);
  --mozart-18: rgba(12,65,196,.18);

  --brahms-06: rgba(206,0,113,.06);
  --brahms-08: rgba(206,0,113,.08);
  --brahms-10: rgba(206,0,113,.10);

  --beethoven-08: rgba(104,13,191,.08);
  --beethoven-12: rgba(104,13,191,.12);

  /* Elevation */
  --shadow: 0 16px 44px rgba(16,24,40,.10);
  --shadow2: 0 10px 26px rgba(16,24,40,.08);
  --shadow3: 0 2px 10px rgba(16,24,40,.06);
  --shadow-inset: inset 0 1px 0 rgba(255,255,255,.75);

  /* Radii */
  --r10:10px;
  --r12:12px;
  --r14:14px;
  --r16:16px;
  --r20:20px;
  --r24:24px;

  /* Focus */
  --focus: 0 0 0 3px rgba(12,65,196,.18);
  --focus2: 0 0 0 4px rgba(104,13,191,.16);

  /* Layout */
  --max: 1400px;
  --gap: 14px;

  /* Type */
  --fs-11: 11px;
  --fs-12: 12px;
  --fs-13: 13px;
  --fs-14: 14px;
  --fs-15: 15px;
  --fs-18: 18px;
  --fs-22: 22px;

  /* Motion */
  --ease: cubic-bezier(.2,.8,.2,1);
  --t-fast: .12s;
  --t: .18s;
  --t-slow: .28s;

  /* Inputs */
  --input-bg:#fff;
  --input-line: rgba(230,232,240,.92);
  --input-line-hover: rgba(12,65,196,.22);
  --input-line-focus: rgba(12,65,196,.32);
  --input-shadow: 0 1px 0 rgba(16,24,40,.02);

  /* Touch */
  --tap: 44px;

  /* Safe areas (iOS notch) */
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-right: env(safe-area-inset-right, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left: env(safe-area-inset-left, 0px);
}

/* =========================
   BASE / RESET
========================= */
*{ box-sizing:border-box; }
html,body{ height:100%; }
html{ scroll-behavior:smooth; }
body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
  color:var(--ink);
  background:
    radial-gradient(1200px 700px at 18% 0%, var(--mozart-10), transparent 60%),
    radial-gradient(900px 600px at 82% 10%, var(--brahms-10), transparent 55%),
    radial-gradient(900px 800px at 50% 92%, var(--beethoven-08), transparent 60%),
    var(--bg);
}
body, input, select, button, textarea{
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}
img{ max-width:100%; display:block; }
::selection{ background: var(--mozart-18); }
a{ color: inherit; text-decoration: none; }
a:hover{ text-decoration: underline; text-underline-offset: 3px; }

@media (prefers-reduced-motion: reduce){
  *{ animation:none !important; transition:none !important; scroll-behavior:auto !important; }
}

/* =========================
   A11Y SKIP LINK
========================= */
.skip{
  position:absolute; left:-999px; top:auto;
  width:1px; height:1px; overflow:hidden;
}
.skip:focus{
  left:calc(16px + var(--safe-left));
  top:calc(16px + var(--safe-top));
  width:auto; height:auto;
  padding:10px 12px;
  background:#fff;
  border:1px solid var(--line);
  border-radius: var(--r14);
  box-shadow: var(--shadow3);
  z-index:80;
}

/* =========================
   FOCUS (A11Y)
========================= */
:focus{ outline:none; }
:focus-visible{
  box-shadow: var(--focus);
  border-radius: var(--r10);
}

/* =========================
   TOPBAR
========================= */
.topbar{
  position:sticky; top:0; z-index:20;
  background: rgba(247,248,252,.74);
  border-bottom:1px solid rgba(230,232,240,.9);
  backdrop-filter: blur(10px);
  display:flex; align-items:center; justify-content:space-between;
  gap:12px;
  padding: calc(12px + var(--safe-top)) calc(16px + var(--safe-right)) 12px calc(16px + var(--safe-left));
}

.topbar__left{ min-width:0; }
.topbar__right{
  display:flex; align-items:center; gap:10px;
  flex-wrap:wrap;
  justify-content:flex-end;
}

/* Brand */
.brand{
  display:flex; align-items:center; gap:12px;
  min-width:0;
}
.brand__logo{
  width:42px; height:42px;
  border-radius: 14px;
  object-fit: contain;
  background: rgba(255,255,255,.7);
  border:1px solid rgba(230,232,240,.95);
  box-shadow: 0 1px 0 rgba(16,24,40,.04);
}
.brand__mark{
  width:42px; height:42px;
  border-radius: 14px;
  background:
    radial-gradient(24px 24px at 30% 30%, rgba(12,65,196,.18), transparent 70%),
    radial-gradient(26px 26px at 70% 70%, rgba(206,0,113,.14), transparent 72%),
    linear-gradient(135deg, rgba(255,255,255,.86), rgba(255,255,255,.55));
  border:1px solid rgba(12,65,196,.22);
  box-shadow: 0 1px 0 rgba(16,24,40,.04);
  display:grid; place-items:center;
  font-weight:950; color:var(--bach);
}
.brand__logo + .brand__mark{ display:none; }

.brand__text{ min-width:0; }
.brand__title{
  font-size: var(--fs-14);
  font-weight: 950;
  letter-spacing:.2px;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.brand__sub{
  font-size: var(--fs-12);
  color:var(--muted);
  margin-top:2px;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* User pill */
.userpill{
  display:inline-flex; align-items:center; gap:10px;
  padding:8px 10px;
  border-radius: 999px;
  background: rgba(255,255,255,.82);
  border:1px solid rgba(230,232,240,.95);
  box-shadow: 0 1px 0 rgba(16,24,40,.03);
}
.userpill__dot{
  width:10px; height:10px; border-radius:999px;
  background: rgba(16,185,129,.85);
  box-shadow: 0 0 0 3px rgba(16,185,129,.12);
}
.userpill__name{
  font-size: var(--fs-13);
  color: var(--muted2);
  font-weight: 800;
  max-width: 20ch;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}

/* =========================
   LAYOUT
========================= */
.layout{
  display:grid;
  grid-template-columns: 360px 1fr;
  gap: var(--gap);
  padding: var(--gap);
  max-width: var(--max);
  margin: 0 auto;
}

/* =========================
   PANELS (Side + Content)
========================= */
.side,
.content{
  background: rgba(255,255,255,.74);
  border: 1px solid rgba(230,232,240,.92);
  border-radius: var(--r24);
  box-shadow: var(--shadow3);
  overflow:hidden;
  position:relative;
}

/* subtle inner gloss */
.side::before,
.content::before{
  content:"";
  position:absolute; left:0; right:0; top:0;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.85), transparent);
  opacity:.75;
  pointer-events:none;
}

.side__search{ padding:16px 16px 10px; }
.side__filters{ padding:10px 16px 16px; border-top:1px solid rgba(230,232,240,.82); }
.side__stats{ padding:12px 16px 16px; border-top:1px solid rgba(230,232,240,.82); }

/* =========================
   FORMS (global)
========================= */
.label{
  display:block;
  font-size: var(--fs-12);
  color:var(--muted);
  margin:0 0 8px;
  font-weight: 800;
}

.row{ display:flex; gap:10px; }
.field{ flex:1; min-width:0; }

select, input[type="text"], input[type="search"], input[type="email"], textarea, button{
  font:inherit;
}

select,
input[type="text"],
input[type="search"],
input[type="email"],
textarea{
  width:100%;
  padding:10px 12px;
  border-radius: var(--r14);
  border:1px solid var(--input-line);
  background: var(--input-bg);
  outline:0;
  color: var(--ink);
  box-shadow: var(--input-shadow);
  transition: border-color var(--t) var(--ease), box-shadow var(--t) var(--ease), transform var(--t-fast) var(--ease);
}

textarea{
  resize: vertical;
  min-height: 96px;
  line-height:1.45;
}

select:hover,
input[type="text"]:hover,
input[type="search"]:hover,
input[type="email"]:hover,
textarea:hover{
  border-color: var(--input-line-hover);
}

select:focus,
input[type="text"]:focus,
input[type="search"]:focus,
input[type="email"]:focus,
textarea:focus{
  box-shadow: var(--focus);
  border-color: var(--input-line-focus);
}

::placeholder{ color: rgba(102,112,133,.78); }

/* Search bar wrapper */
.search{
  display:flex; gap:8px; align-items:center;
  background:#fff;
  border:1px solid var(--line);
  border-radius: var(--r14);
  padding:10px 10px;
  box-shadow: 0 1px 0 rgba(16,24,40,.02);
  transition: box-shadow var(--t) var(--ease), border-color var(--t) var(--ease);
}
.search:focus-within{
  border-color: rgba(12,65,196,.30);
  box-shadow: var(--focus);
}
.search input{
  width:100%;
  border:0; outline:0;
  font-size: var(--fs-14);
  background:transparent;
  color: var(--ink);
}

/* =========================
   CHIPS
========================= */
.chips{ display:flex; flex-wrap:wrap; gap:8px; margin-top:12px; }
.chip{
  border:1px solid rgba(12,65,196,.22);
  background: rgba(12,65,196,.07);
  color: var(--bach);
  padding:8px 10px;
  border-radius: 999px;
  font-size: var(--fs-12);
  cursor:pointer;
  user-select:none;
  transition: transform var(--t-fast) var(--ease), filter var(--t-fast) var(--ease), border-color var(--t-fast) var(--ease), background var(--t-fast) var(--ease);
  -webkit-tap-highlight-color: transparent;
}
.chip:hover{ filter: brightness(0.99); transform: translateY(-1px); }
.chip:active{ transform: translateY(0px); }

.chip[aria-pressed="true"]{
  border-color: rgba(206,0,113,.35);
  background: rgba(206,0,113,.10);
  color: rgba(34,10,99,.95);
}

.hint{
  margin-top:10px;
  font-size: var(--fs-12);
  color:var(--muted);
  line-height:1.45;
}

/* =========================
   STATS
========================= */
#stats{
  display:grid;
  gap:10px;
}
#stats .stat,
#stats .statcard{
  background:#fff;
  border:1px solid var(--line);
  border-radius: var(--r20);
  padding:12px;
  box-shadow: 0 1px 0 rgba(16,24,40,.02);
}

/* =========================
   CONTENT
========================= */
.content{ padding: 14px; }

.content__header{
  display:flex; align-items:flex-end; justify-content:space-between; gap:10px;
  padding: 6px 4px 12px;
  border-bottom: 1px solid rgba(230,232,240,.68);
}

.h1{
  margin:0;
  font-size: var(--fs-18);
  letter-spacing:.2px;
  font-weight: 980;
}
.muted{
  color:var(--muted);
  font-size: var(--fs-13);
  margin-top:6px;
  line-height:1.45;
}
.content__actions{
  display:flex; gap:10px;
  flex-wrap:wrap;
  align-items:center;
}

/* =========================
   BUTTONS
========================= */
.btn{
  min-height: var(--tap);
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  border:1px solid rgba(12,65,196,.22);
  background:
    radial-gradient(500px 60px at 10% 0%, rgba(12,65,196,.13), transparent 60%),
    linear-gradient(180deg, rgba(12,65,196,.10), rgba(12,65,196,.06));
  color: var(--bach);
  padding:10px 12px;
  border-radius: var(--r14);
  cursor:pointer;
  font-weight:900;
  font-size: var(--fs-13);
  box-shadow: 0 1px 0 rgba(16,24,40,.02);
  transition: transform var(--t-fast) var(--ease), box-shadow var(--t) var(--ease), filter var(--t-fast) var(--ease), border-color var(--t) var(--ease);
  white-space:nowrap;
  user-select:none;
  -webkit-tap-highlight-color: transparent;
}
.btn:hover{
  filter: brightness(0.99);
  box-shadow: var(--shadow3);
  border-color: rgba(12,65,196,.30);
}
.btn:active{ transform: translateY(1px); }

.btn--ghost{
  background:#fff;
  border:1px solid var(--line);
  color: var(--ink);
}
.btn--ghost:hover{ border-color: rgba(102,112,133,.28); }

.btn--danger{
  border-color: rgba(206,0,113,.28);
  background:
    radial-gradient(500px 60px at 10% 0%, rgba(206,0,113,.12), transparent 60%),
    linear-gradient(180deg, rgba(206,0,113,.10), rgba(206,0,113,.06));
  color: rgba(34,10,99,.98);
}
.btn--danger:hover{ border-color: rgba(206,0,113,.36); }

.btn:disabled{
  opacity:.55;
  cursor:not-allowed;
  transform:none;
  box-shadow:none;
}

/* Icon button (x) */
.iconbtn{
  width:44px; height:44px;
  display:grid; place-items:center;
  border-radius: 999px;
  border:1px solid rgba(230,232,240,.92);
  background:#fff;
  box-shadow: 0 1px 0 rgba(16,24,40,.02);
  cursor:pointer;
  transition: transform var(--t-fast) var(--ease), box-shadow var(--t) var(--ease), border-color var(--t) var(--ease);
  -webkit-tap-highlight-color: transparent;
}
.iconbtn:hover{
  box-shadow: var(--shadow3);
  border-color: rgba(12,65,196,.22);
}
.iconbtn:active{ transform: translateY(1px); }

/* =========================
   INLINE STATE (loader/error)
========================= */
.inline-state{
  display:grid;
  place-items:center;
  text-align:center;
  gap:8px;
  padding: 26px 14px 18px;
  margin: 10px 2px 0;
  border:1px dashed rgba(102,112,133,.25);
  border-radius: var(--r20);
  background: rgba(255,255,255,.72);
}
.inline-state__icon{ font-size: 22px; }
.inline-state__title{ font-weight: 950; }
.inline-state__sub{
  color: var(--muted);
  font-size: var(--fs-13);
  line-height:1.45;
  max-width: 56ch;
}

.inline-state[data-state="error"]{
  border-color: rgba(206,0,113,.25);
  background: rgba(206,0,113,.06);
}
.inline-state[data-state="loading"] .inline-state__icon{
  animation: spin 1.1s linear infinite;
  transform-origin: center;
}

/* =========================
   GRID + CARDS
========================= */
.grid{
  display:grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap:12px;
  padding: 12px 2px 2px;
}

.card{
  background:#fff;
  border:1px solid var(--line);
  border-radius: var(--r20);
  padding:12px 12px 10px;
  box-shadow: 0 1px 0 rgba(16,24,40,.02);
  cursor:pointer;
  transition: transform var(--t) var(--ease), box-shadow var(--t) var(--ease), border-color var(--t) var(--ease);
  position:relative;
  overflow:hidden;
}
.card::after{
  content:"";
  position:absolute; inset:-40px;
  background:
    radial-gradient(220px 120px at 15% 10%, rgba(12,65,196,.08), transparent 60%),
    radial-gradient(240px 140px at 90% 0%, rgba(206,0,113,.06), transparent 55%);
  opacity:0;
  transition: opacity var(--t) var(--ease);
  pointer-events:none;
}
.card:hover{
  transform: translateY(-2px);
  box-shadow: var(--shadow2);
  border-color: rgba(12,65,196,.26);
}
.card:hover::after{ opacity:1; }

.card:focus-visible{
  box-shadow: var(--focus2);
  border-color: rgba(104,13,191,.24);
}

.card__top{ display:flex; align-items:center; justify-content:space-between; gap:10px; }
.card__title{
  margin:0;
  font-size: var(--fs-14);
  font-weight: 980;
  letter-spacing:.2px;
  line-height:1.25;
}

.pill{
  font-size: 11px;
  padding:6px 8px;
  border-radius:999px;
  border:1px solid rgba(102,112,133,.20);
  color: var(--muted2);
  background: var(--panel2);
  white-space:nowrap;
}

.card__sum{
  margin:10px 0 0;
  color: var(--muted);
  font-size: 12.5px;
  line-height:1.45;
  min-height: 34px;
}

.card__meta{
  display:flex; gap:8px; align-items:center;
  margin-top:10px;
  color: var(--muted);
  font-size: var(--fs-12);
  flex-wrap: wrap;
}

/* =========================
   BADGES
========================= */
.badge{
  display:inline-flex; align-items:center; justify-content:center;
  font-size: 11px; font-weight: 950;
  padding:6px 10px;
  border-radius: 999px;
  border: 1px solid rgba(16,24,40,.10);
  background: rgba(16,24,40,.03);
  color: var(--ink);
}
.badge--urgent{
  border-color: rgba(206,0,113,.30);
  background: rgba(206,0,113,.09);
  color: rgba(34,10,99,.98);
}
.badge--important{
  border-color: rgba(12,65,196,.28);
  background: rgba(12,65,196,.08);
  color: rgba(34,10,99,.98);
}
.badge--normal{
  border-color: rgba(102,112,133,.22);
  background: rgba(102,112,133,.07);
  color: rgba(16,24,40,.95);
}

/* =========================
   EMPTY STATE
========================= */
.empty{
  text-align:center;
  padding: 40px 14px 50px;
}
.empty__icon{ font-size:28px; }
.empty__title{ font-weight: 980; margin-top:10px; }
.empty__sub{
  color:var(--muted);
  margin-top:8px;
  font-size: var(--fs-13);
  line-height:1.45;
}

/* =========================
   MODAL / DRAWER
========================= */
.modal{ position:fixed; inset:0; z-index:40; }
.modal[hidden]{ display:none; }

.modal__backdrop{
  position:absolute; inset:0;
  background: rgba(16,24,40,.35);
  backdrop-filter: blur(4px);
  animation: fadeIn var(--t) var(--ease) both;
}

.modal__panel{
  position:absolute;
  right:calc(16px + var(--safe-right));
  top:calc(16px + var(--safe-top));
  bottom:calc(16px + var(--safe-bottom));
  width:min(560px, calc(100% - 32px));
  background:#fff;
  border-radius: var(--r24);
  border:1px solid rgba(230,232,240,.92);
  box-shadow: var(--shadow);
  display:flex; flex-direction:column;
  overflow:hidden;
  animation: slideIn var(--t) var(--ease) both;
}

/* Centered small modal (help etc.) */
.modal__panel--small{
  left:50%; right:auto; top:50%; bottom:auto;
  transform: translate(-50%, -50%);
  width:min(560px, calc(100% - 32px));
  max-height: calc(100% - 32px);
  animation: popIn var(--t) var(--ease) both;
}

.modal__head{
  display:flex; align-items:center; gap:10px;
  padding: 14px 14px 12px;
  border-bottom: 1px solid rgba(230,232,240,.85);
  background: linear-gradient(180deg, rgba(251,252,255,.95), rgba(251,252,255,.62));
}
.modal__title{
  margin:0;
  font-size: var(--fs-15);
  font-weight: 980;
  letter-spacing:.2px;
  flex:1;
}
.modal__body{
  padding: 14px;
  overflow:auto;
}
.modal__foot{
  padding: 12px 14px;
  border-top:1px solid rgba(230,232,240,.85);
  display:flex; gap:10px; justify-content:flex-end;
  background: var(--panel2);
  position: sticky;
  bottom: 0;
}

.lead{
  margin:0 0 14px;
  color: var(--muted);
  line-height:1.55;
}

.section{ margin-top:14px; }
.section__title{
  font-size: var(--fs-12);
  color: var(--muted);
  font-weight: 950;
  letter-spacing:.25px;
  text-transform:uppercase;
  margin-bottom:10px;
}

/* KV */
.kv{
  display:grid;
  grid-template-columns: 1fr;
  gap:10px;
}
.kv__item{
  border:1px solid var(--line);
  border-radius: var(--r16);
  padding: 10px 12px;
  background:#fff;
}
.kv__k{ font-size: var(--fs-12); color:var(--muted); font-weight: 950; }
.kv__v{ margin-top:6px; white-space:pre-wrap; line-height:1.55; font-size: var(--fs-13); }

/* Checklist */
.checklist{ display:grid; gap:8px; }
.check{
  display:flex; gap:10px; align-items:flex-start;
  border:1px dashed rgba(102,112,133,.22);
  background: rgba(102,112,133,.06);
  padding:10px 12px;
  border-radius: var(--r16);
  transition: border-color var(--t-fast) var(--ease), background var(--t-fast) var(--ease);
}
.check:hover{
  border-color: rgba(12,65,196,.22);
  background: rgba(12,65,196,.05);
}
.check input{ margin-top:2px; accent-color: var(--mozart); }
.check label{ line-height:1.45; font-size: var(--fs-13); cursor:pointer; }

/* Lists */
.list{ margin:0; padding-left:18px; color: var(--ink); }
.list li{ margin:8px 0; }

/* =========================
   EDITOR (Nuevo/Editar)
========================= */
#editor .lead{
  margin-top: 2px;
  margin-bottom: 12px;
}

#editor .form{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}
#editor .form .span-2{ grid-column: 1 / -1; }

#editor .field{
  display:flex;
  flex-direction:column;
  gap:8px;
}

#editor input[type="text"],
#editor input[type="search"],
#editor input[type="email"],
#editor select,
#editor textarea{
  border-radius: var(--r16);
  padding: 11px 12px;
}

#editor textarea{ min-height: 112px; }
#editor textarea#eSteps{ min-height: 140px; }
#editor textarea#eFlow{
  min-height: 120px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size: 12.5px;
}

#editor .label,
#editor label{
  font-size: var(--fs-12);
  font-weight: 900;
  color: var(--muted2);
  letter-spacing: .12px;
}

#editor .help{
  font-size: var(--fs-12);
  color: var(--muted);
  line-height: 1.45;
}

#editor .modal__foot .btn{
  padding: 11px 14px;
  border-radius: 16px;
}

/* =========================
   TOAST (si lo creas desde JS)
========================= */
#toast{ border-radius: 14px; }

/* =========================
   SCROLLBARS (subtle)
========================= */
@supports selector(::-webkit-scrollbar){
  *::-webkit-scrollbar{ width: 10px; height: 10px; }
  *::-webkit-scrollbar-thumb{
    background: rgba(102,112,133,.25);
    border-radius: 999px;
    border: 3px solid rgba(255,255,255,.78);
  }
  *::-webkit-scrollbar-track{ background: transparent; }
}

/* =========================
   ANIMATIONS
========================= */
@keyframes fadeIn{
  from{ opacity:0; }
  to{ opacity:1; }
}
@keyframes slideIn{
  from{ transform: translateX(10px); opacity:.9; }
  to{ transform: translateX(0); opacity:1; }
}
@keyframes popIn{
  from{ transform: translate(-50%,-50%) scale(.98); opacity:.9; }
  to{ transform: translate(-50%,-50%) scale(1); opacity:1; }
}
@keyframes spin{
  from{ transform: rotate(0deg); }
  to{ transform: rotate(360deg); }
}

/* =========================
   RESPONSIVE
========================= */
@media (max-width: 980px){
  .layout{ grid-template-columns: 1fr; }
  .grid{ grid-template-columns: repeat(2, minmax(0, 1fr)); }

  /* Editor a una columna en tablet */
  #editor .form{ grid-template-columns: 1fr; }
}

@media (max-width: 560px){
  .grid{ grid-template-columns: 1fr; }
  .row{ flex-direction:column; }

  .topbar{
    padding: calc(10px + var(--safe-top)) calc(12px + var(--safe-right)) 10px calc(12px + var(--safe-left));
  }

  .brand__logo, .brand__mark{
    width:38px; height:38px; border-radius: 13px;
  }

  .content{ padding: 12px; }

  /* Drawer full-height feel en móvil */
  .modal__panel{
    top: calc(10px + var(--safe-top));
    bottom: calc(10px + var(--safe-bottom));
    right: calc(10px + var(--safe-right));
    left: calc(10px + var(--safe-left));
    width: auto;
    border-radius: 22px;
  }

  /* Botones más “dedo-friendly” */
  .btn{ min-height: 46px; }

  /* Textareas menos agresivas en móvil */
  textarea{ min-height: 96px; }
  #editor textarea#eSteps{ min-height: 132px; }
}

/* =========================
   PRINT
========================= */
@media print{
  .topbar, .side, .content__actions, .modal, #toast { display:none !important; }
  body{ background:#fff; }
  .layout{ grid-template-columns: 1fr; max-width: none; padding:0; }
  .content{ border:0; box-shadow:none; }
}